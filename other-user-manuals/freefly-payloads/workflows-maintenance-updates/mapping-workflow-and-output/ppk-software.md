---
description: >-
  These free applications make it easy and simple to improve the accuracy of
  your survey through their use of Post Processed Kinematic corrections.
---

# PPK Software

## General Steps Before PPK Process:

If you are not able to follow these steps exactly, there is more guidance below.

1. Set up your base station (list of tested stations are below) and get it recording
2. Fly your mission with Astro, then wait for it to finish processing photos after landing
   1. Shutoff Astro
3. Pull USB-C stick, and insert into iPad (if accessing base-station data from iPad)
4. Go to Files app, browse to USB drive, and determine which folder has the files from this scan. i.e. folder 58
5. If using EMLID REACH:
   1. Open EMLID app:
      1. Stop logging all 3 logs (position, raw data, base correction)
      2. After they are zipped, download all 3 files to the usb stick in the same directory as the scan

## Freefly PPK

Freefly PPK Desktop Application takes photos and GPS data generated by Astro during a Mapping mission, as well as data from a GNSS base station, and applies the Post-Processing Kinematics (PPK) algorithm to tag photos with highly accurate geotags.&#x20;



**Download** the software from [https://freeflysystems.com/support/astro-support](https://freeflysystems.com/support/astro-support)

Current PC Version: v1.1.0 - Released 08/2024

Current Mac Version: v1.1.0 - Released 08/2024

**Table of Contents:**

1. Compatible Devices, Download Links
2. Input, Output, Workflow
3. Debugging tips if you encounter errors

### Compatible Devices

**Operating Systems**

* #### Windows PC - Tested on Windows 10
*   #### **macOS - Tested on M1 only**

    Note, for the current app version, you will need to override current mac security settings through instructions provided here: [https://support.apple.com/en-us/HT202491](https://support.apple.com/en-us/HT202491)

#### GNSS Base Stations

* Trimble R2,10,12
* Emlid RS2
* Generally, any device that can output RINEX (Observation and Navigation data files)

### Input

{% hint style="info" %}
**Important Tip: PPK process and upload to mapping software is 10x faster if you have the files in your local storage instead of thumb drive**
{% endhint %}

* Output folder from High Res Mapping Payload.
* RINEX files (OBS and Nav Data files) from GNSS base station _(that was actively recording GNSS data for the full duration of the time that the Astro mission was running)_.
* GNSS base station coordinate
  * Using pre-surveyed point as reference coordinate
  * Using Reference Network calculation (i.e. NOAA's CORS, Washington state's WSRN)&#x20;
  * For very basic results, averaged value from base station rinex file

### Output

Photos in PPK\_Photos folder with corrected geotags.&#x20;



### Workflow

{% hint style="info" %}
Updated 2022-06-01
{% endhint %}

**PRE-PPK CHECKS**

1.  As summarized above, to start PPK-ing your photos to get centimeter level geotag accuracy, you need to:

    * Complete an Astro Map mapping mission that writes photos, imagelog.json, \*capture.obs, and \*capture.json file into a mission folder (see Fig 1 below) into the USB-C thumb-drive. This is a simple and streamlined process, and you will generate this folder if you follow with the instructions in Astro Mapping Payload: Quick Map Workflow.



    ![](<../../../../.gitbook/assets/image (59).png>)

_Fig 1. Here is what the mission folder generated by an Astro Map mission might look like:_

* Have a GNSS base-station running and recording satellite data throughout the duration of the flight that can produce (Observation and Navigation data files). Grab the RINEX data files (usually ends with .<##>O - for OBS or .<##>P for NAV, sometimes just .RNX for both file types). If the file names are ambiguous, you can inspect the files and look at the first few lines to see if they contain the keywords Observation (for obs file) or Navigation (for nav file) data file. **IMPORTANT - Ensure that the NAV data file is a "MIXED NAV" data file that contains nav data for all constellations.**&#x20;

1. Grab the Observation and Navigation data files (either individually) or the folder that contains them and place it into the Astro Map mission folder that contains the photos and the other mapping mission artifacts (imagelog.json, \*capture.obs, and \*capture.json).

Placing base station file into the folder shown below:

![](<../../../../.gitbook/assets/image (34).png>)

_Fig 2. Placing base-station files into the folder shown above. The file types might be different_

**Pre-PPK Notes:**

* Do not close any pop-up cmd prompt or terminal windows (this is due to the application running a subprocess necessary for PPK-ing)
* It's a good habit to check to ensure that the original geotags on a couple of the photos somewhat correspond to the image location.
  * To do this: Use an exif inspection tool, grab the geotag from an image, search up coordinates on Google Earth, compare to see if the photo content somewhat matches up with coordinates on Google earth
  * If the images do not align, it might be a good idea to get the flight log (.ulog) file from the mission and use the Use ULOG workflow in the Freefly PPK app to get proper alignment.&#x20;

**Freefly PPK Processing:**

1. Open FreeflyPPK application.
2. Click on browse at the top to choose the Astro Map mission and select the folder.
3. The application should browse the folder and search for the requirements and automatically fill in all of the requirements.&#x20;

![](<../../../../.gitbook/assets/image (80).png>)

4\. If you know where the base station ground coordinate was, then enter it. This can be done using a GNSS reference network processing provider (i.e. in Washington state you can use Washington State Reference Network, in the U.S. you can use NOAA CORS and upload your base RINEX files)  You can use either DMS or Decimal coordinates (Click the `DMS Coordinates` check-box.)

5\. If you don't know the base station coordinate, by changing from `MANUAL` on the drop down to `AVERAGE FROM OBS` you can get a very rough estimate of the base station. It applies single point positioning to the base station RINEX files. The averaged postion will be displayed on the status bar once the project processing begins.

6\. Go ahead and select how high you placed the receiver from the ground (usually your base station tripod pole will have a marking to let you know). The application will take care of antenna phase center variation based on the base-station type detected from the base-station OBS file.&#x20;

7\. If you are rerunning the same mapping mission folder, checking the Overwrite Output check-box will overwrite the output folder with the current processing output. It is set to overwrite on default since the application can otherwise keep on making copy of the photos and take a lot of space on your computer. If the Overwrite Output check-box is not checked, then the application will rename the previous folder and save the output of the current processing to PPK\__Photos. \*TIP: you want to explore output with multiple settings (i.e. different base station coordinates or base station files), it might be beneficial to rename the PPK\_Photos folder to something more useful\*_

8\. Once all of the project requirements are met, you will be able to click the Process button and the application will correct the geotags on your photos after it conducts PPK on them. It will output them into the PPK\_Photos folder and keep your original images untouched. Monitor the output and ensure all or most of the photos are tagged with Q=1 quality. The Q value corresponds to the quality of the corrected geotag. Q=1 is great. Q=2 is ok. Anything higher is not accurate.

9\. Once your images are PPK-ed, you can use a map generation provider like ESRI Sitescan (which is recommended and we have tested on) and upload the images from the PPK\_Photos folder. In the Advanced Processing Settings:

* If you completed the PPK process with a surveyed point or reference network, use the +/- margin of error they provided to you in the base station location for the geolocation accuracy.
* If you use the AVERAGE OBS FILE option in the FreeflyPPK app, use +/- 100 cm. Note that it is not recommended to run AVERAGE OBS if you want high fidelity maps.&#x20;

**Debugging Tips:**

* Known Issue: If drone is flying below sealevel or drone is flying at negative altitude in the chosen base-station coordinate system, then the application will fail the geotagging process (status list error). This will be fixed in a future release.
* If you entered base station coordinates in Degrees, Minute, Second format, make sure you use the correct sign. i.e. If the coordinate you are entering is 122° 09' 7.93789" W, on Freefly PPK, you should enter -122  09  7.93789&#x20;
* If the correct base station file is not be detected correctly, remove all of the base files from inside of the project path folder. Then, individually go into modify the selected base and rinex files using the modify buttons below the status box. Check content inside the base files for "Observation" and "Navigation" to ensure you are choosing the correct files.
* One of the first debugging things you can do is to close the application and reopen it. More advanced users can go in and delete the .ppk\_history file in their home directory to remove application cache file. &#x20;
* Check to see if the rtkdata\_events.pos in the working directory has been generated properly. If everything looks good there, but there is an issue with photo tagging. (i.e. "Issue with abc.jpg tagging" alert, then there is likely an error with your filesystems (see common file systems error).
* Common file systems errors: Not enough space on your hard drive. Make sure the project path has plenty of space. A bunch of 25MP images can fill up your storage device quickly. Again, as previously mentioned, you will get much better performance if your project folder is in your local hard-drive instead of an extenal drive.
* If you have any issues with Freefly PPK and have questions for Freefly Support team, it would help if you sent as many of your files as you are able to (i.e content of working directory, capture.obs, sequence.json, and base-directory folder). It helps to include a screenshot of the application during an error, but ensure you expand the status list so that the whole error is visible in the photo. Since this is our first release of Freefly PPK software, we are actively working to improve the user experience based on feedback. &#x20;

## Precise Flight&#x20;

Precise Flight by Auterion is an alternative option for the PPK workflow. It can be downloaded from the App Store.&#x20;

### Compatible Devices:

iOS devices - primarily useful with iPad

### Precise Flight by Auterion Workflow

* Set up base station and get it recording
* Fly mission with astro, wait for it to finish processing photos after landing
  1. Shutoff astro
* Pull usb stick, and place into ipad
* Go to files app, browse to usb stick, and determine which folder has the files from this scan. I.e. folder 58
* Open emlid app
  1. Stop logging all 3 logs (position, raw data, base correction)
  2. After they are zipped
  3. Download all 3 files to the usb stick in the same directory as the scan
* Extract data
  1. Go to files app
  2. Browse to the folder with the photos in them
  3. Click once on the zip file with the emlid raw RINEX data in it to unzip
  4. It will create a folder in that directory
* Delete old data?
* Go to preciseflight app
  1. Select base station folder, will be the RINEX directory inside of the flight folder
  2. Select the vehicle folder- it is the folder with your mission number such as “58” that has the photos in it
  3. Decide if you want to set base position manually, enter as desired
  4. Enable compensate camera offset
  5. Hit process, wait the 30-60 seconds for processing
  6. When processing is complete, the files will be located in the Auterion Precise Flight app on the ipad (not on the USB stick).&#x20;
  7. When working properly, Sitescan app can be pointed at that folder to upload the photos
  8. I’ve been using files app to copy the PPK’d photos  into a new folder on the usb drive and then transferring to computer.
